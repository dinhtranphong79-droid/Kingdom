<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tài khoản</title>

<style>
:root{
  --bg:#f5f7fb;
  --card:#ffffff;
  --accent:#2563eb;
}
*{box-sizing:border-box;font-family:Inter,Arial,sans-serif;}
body{
  margin:0;
  padding:20px;
  background:var(--bg);
  display:flex;
  justify-content:center;
}
.wrap{
  width:100%;
  max-width:820px;
  background:var(--card);
  padding:20px;
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}
h1{margin-top:0;font-size:22px;}
.status{
  padding:10px;
  background:#eef4ff;
  border-radius:10px;
  margin-bottom:15px;
  font-size:14px;
}
.acc{
  padding:14px;
  background:#f8fafc;
  border-radius:12px;
  margin-bottom:10px;
  cursor:pointer;
  border:1px solid #e5e7eb;
  transition:.25s;
}
.acc:hover{
  background:#e0e7ff;
}
.acc b{font-size:16px;}
.logout{
  background:#ef4444;
  color:white;
  border:none;
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="wrap">

<h1>Tài khoản</h1>
<div id="authStatus" class="status">Đang kiểm tra đăng nhập…</div>

<button class="logout" onclick="logout()">Đăng xuất</button>

<h2 style="margin-top:20px;font-size:18px;">Click để đăng nhập account</h2>
<div id="accList"></div>

</div>

<script>
/* ======================================================
   LẤY FIREBASE TỪ INDEX.HTML
   ====================================================== */
const FB = window.parent.__FB;
if(!FB){
  document.getElementById("authStatus").innerText =
    "❌ Không nhận được Firebase từ index.html";
  throw "Firebase not found";
}

const auth = FB.auth;

/* ======================================================
   PASSWORD DÙNG CHUNG (bạn đổi tùy ý)
   ====================================================== */
const DEFAULT_PASSWORD = "1234567";

/* ======================================================
   9 ACCOUNT DOLVAR
   ====================================================== */
const ACCOUNTS = [
  "minhlanne@dolvar.app",
  "minhlannho@dolvar.app",
  "dolvar@dolvar.app",
  "dolvarash@dolvar.app",
  "dolvaraegis@dolvar.app",
  "dolvarreign@dolvar.app",
  "dolvarreaper@dolvar.app",
  "dolvartroth@dolvar.app",
  "dolvarbastion@dolvar.app"
];

const list = document.getElementById("accList");

/* ======================================================
   RENDER ACCOUNT LIST
   ====================================================== */
ACCOUNTS.forEach(email=>{
  const div = document.createElement("div");
  div.className = "acc";
  div.innerHTML = `
    <b>${email}</b><br>
    <small>Click để đăng nhập</small>
  `;
  div.onclick = ()=>loginAccount(email);
  list.appendChild(div);
});

/* ======================================================
   LOGIN / AUTO REGISTER
   ====================================================== */
async function loginAccount(email){
  try{
    await auth.signInWithEmailAndPassword(email, DEFAULT_PASSWORD);
  }catch(err){
    if(err.code === "auth/user-not-found"){
      await auth.createUserWithEmailAndPassword(email, DEFAULT_PASSWORD);
    }else{
      alert(err.message);
    }
  }
}

/* ======================================================
   LOGOUT
   ====================================================== */
function logout(){
  auth.signOut();
}

/* ======================================================
   AUTH STATE
   ====================================================== */
auth.onAuthStateChanged(user=>{
  const s = document.getElementById("authStatus");
  if(!user){
    s.innerHTML = "Chưa đăng nhập";
    return;
  }
  s.innerHTML = `
    ✅ Đã đăng nhập<br>
    <b>${user.email}</b><br>
    UID: ${user.uid}
  `;
});
</script>

</body>
</html>
